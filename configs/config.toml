# ==============================================================================
#  üõ°Ô∏è  LoopWarden Configuration
# ==============================================================================

[network]
# La interfaz f√≠sica donde escucharemos e inyectaremos
# IMPORTANTE: Cambia esto a tu interfaz real (ej: eth0, eno1, enp3s0)
interface = "eno1"
# Tama√±o de captura (SnapLen). 2048 es suficiente para headers + payload b√°sico.
snaplen = 2048

[alerts]
# --- Integraciones Externas ---
# Dejar vac√≠o para desactivar.
webhook_url = ""    # Ej: "https://hooks.slack.com/services/..."
syslog_server = ""  # Ej: "192.168.1.50:514"

# --- SMTP (Email) ---
smtp_enabled = false
smtp_host = "smtp.gmail.com"
smtp_port = 587
smtp_user = "admin@example.com"
smtp_pass = "secret"
smtp_to = "ops@example.com"
smtp_from = "loopwarden@example.com"

[algorithms]

    # --- ALGORITMO 1: EtherFuse (Pasivo - Payload Fingerprint) ---
    # Detecta bucles mediante el hash del payload. Si el mismo paquete
    # se ve demasiadas veces en poco tiempo, es un bucle.
    [algorithms.etherfuse]
    enabled = true
    history_size = 4096      # Tama√±o del buffer circular de hashes
    alert_threshold = 50     # Cu√°ntos duplicados disparan la alerta
    storm_pps_limit = 5000   # Umbral de pps global para alerta de tormenta masiva

    # --- ALGORITMO 2: ActiveProbe (Activo - Injection) ---
    # Inyecta un paquete Ethernet especial peri√≥dicamente. 
    # Si el paquete vuelve a la interfaz, hay un bucle f√≠sico confirmado.
    [algorithms.active_probe]
    enabled = true
    interval_ms = 1000       # Frecuencia de inyecci√≥n (1 segundo)
    ethertype = 65535        # 0xFFFF (Reservado, seguro para pruebas)
    magic_payload = "LOOPWARDEN_PROBE"

    # --- ALGORITMO 3: MAC Storm (Pasivo - MAC Velocity) ---
    # Detecta si una √∫nica direcci√≥n MAC est√° enviando demasiados paquetes.
    # √ötil para detectar NICs defectuosas o bucles en puertos de acceso.
    [algorithms.mac_storm]
    enabled = true
    max_pps_per_mac = 2000   # Un host normal rara vez pasa de 1000 pps de broadcast

    # --- ALGORITMO 4: FlapGuard (Pasivo - Topology Stability) ---
    # [NUEVO] Detecta si una MAC salta entre diferentes VLANs r√°pidamente.
    # S√≠ntoma cl√°sico de "Port Leakage" o bucle entre Troncales.
    [algorithms.flap_guard]
    enabled = true
    threshold = 5            # Alerta si una MAC cambia de VLAN > 5 veces en 1 segundo

    # --- ALGORITMO 5: ArpWatchdog (Pasivo - Protocol Storm) ---
    # [NUEVO] Monitoriza espec√≠ficamente tormentas de ARP (Broadcast Radiation).
    # Los bucles suelen amplificar ARP antes que cualquier otro tr√°fico.
    [algorithms.arp_watch]
    enabled = true
    max_pps = 500            # M√°s de 500 WHO-HAS por segundo es sospechoso
