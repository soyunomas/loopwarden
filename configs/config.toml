# ==============================================================================
#  üõ°Ô∏è  LoopWarden Configuration
# ==============================================================================

[network]
interface = "eno1"
snaplen = 2048

[alerts]
# Syslog se mantiene simple
syslog_server = ""  # Ej: "192.168.1.50:514"

# --- Webhook (Slack/Teams/Discord) ---
[alerts.webhook]
enabled = false
url = "https://hooks.slack.com/services/..."

# --- SMTP (Email) ---
[alerts.smtp]
enabled = false
host = "smtp.gmail.com"
port = 587
user = "admin@example.com"
pass = "secret"
to = "ops@example.com"
from = "loopwarden@example.com"

# --- Telegram Bot ---
[alerts.telegram]
enabled = false
token = ""
chat_id = ""

[algorithms]

    # --- ALGORITMO 1: EtherFuse ---
    [algorithms.etherfuse]
    enabled = true
    history_size = 4096
    alert_threshold = 200
    storm_pps_limit = 15000

    # --- ALGORITMO 2: ActiveProbe ---
    [algorithms.active_probe]
    enabled = true
    interval_ms = 1000
    ethertype = 65535
    magic_payload = "LOOPWARDEN_PROBE"
    target_mac = "" # Opcional: "FF:FF:FF:FF:FF:FF" para broadcast, o una MAC unicast espec√≠fica.

    # --- ALGORITMO 3: MAC Storm ---
    [algorithms.mac_storm]
    enabled = true
    max_pps_per_mac = 2000

    # --- ALGORITMO 4: FlapGuard ---
    [algorithms.flap_guard]
    enabled = true
    threshold = 5

    # --- ALGORITMO 5: ArpWatchdog ---
    [algorithms.arp_watch]
    enabled = true
    max_pps = 500

    # --- ALGORITMO 6: DhcpHunter ---
    # Detecta servidores DHCP no autorizados.
    [algorithms.dhcp_hunter]
    enabled = true
    # MACs de tus servidores DHCP leg√≠timos (Ej: Gateway, Windows Server)
    trusted_macs = ["00:15:5d:01:02:03", "aa:bb:cc:dd:ee:ff"] 
    # Rangos de IP desde donde es v√°lido recibir DHCP Offers.
    trusted_cidrs = ["192.168.1.0/24", "10.0.0.0/8"]

    # --- ALGORITMO 7: FlowPanic ---
    # Detecta inundaci√≥n de tramas PAUSE (802.3x), s√≠ntoma de NIC averiada o saturaci√≥n.
    [algorithms.flow_panic]
    enabled = true
    max_pause_pps = 50 # 50/segundo es muy alto para tr√°fico normal.

    # --- ALGORITMO 8: RaGuard ---
    # Detecta Routers IPv6 no autorizados (protecci√≥n contra MITM en IPv6).
    [algorithms.ra_guard]
    enabled = true
    trusted_macs = ["aa:bb:cc:dd:ee:ff"] # Solo la MAC del Gateway/Firewall.

    # --- ALGORITMO 9: McastPolicer ---
    # Limita el tr√°fico Multicast global (ej: streaming, clonaci√≥n).
    [algorithms.mcast_policer]
    enabled = true
    max_pps = 8000

# --- TELEMETR√çA Y OBSERVABILIDAD ---
# Expone m√©tricas Prometheus en /metrics
[telemetry]
enabled = true
listen_address = ":9090" # Ej: ":9090" (Todo), "127.0.0.1:9090" (Solo local)
