# ==============================================================================
#  üõ°Ô∏è  LoopWarden Configuration
# ==============================================================================

[system]
# Identificador √∫nico de este despliegue (√∫til para saber de qu√© rack viene la alerta)
sensor_name = "LoopWarden-Core-Stack"

# Archivo de logs. Usa "" para consola o "/dev/null" para descartar.
log_file = "loopwarden.log"

[network]
# ‚ö†Ô∏è CAMBIO CR√çTICO: Ahora es una lista de interfaces.
# LoopWarden levantar√° un motor de detecci√≥n independiente para cada una.
interfaces = ["eno1", "eno2", "vlan10"] 

# Longitud de captura (SnapShot Length). 2048 bytes es suficiente para cabeceras + payload.
snaplen = 2048

[alerts]
syslog_server = ""  # Ej: "192.168.1.50:514"

# --- Webhook (Slack/Teams/Discord) ---
[alerts.webhook]
enabled = false
url = "https://hooks.slack.com/services/..."

# --- SMTP (Email) ---
[alerts.smtp]
enabled = false
host = "smtp.gmail.com"
port = 587
user = "admin@example.com"
pass = "secret"
to = "ops@example.com"
from = "loopwarden@example.com"

# --- Telegram Bot ---
[alerts.telegram]
enabled = false
token = ""
chat_id = ""

[algorithms]

    # --- ALGORITMO 1: EtherFuse ---
    [algorithms.etherfuse]
    enabled = true
    history_size = 4096
    alert_threshold = 200
    storm_pps_limit = 15000

    # --- ALGORITMO 2: ActiveProbe ---
    [algorithms.active_probe]
    enabled = true
    interval_ms = 1000
    ethertype = 65535
    magic_payload = "LOOPWARDEN_PROBE" # El sistema a√±adir√° "|eno1" autom√°ticamente.
    target_mac = "" 

    # --- ALGORITMO 3: MAC Storm ---
    [algorithms.mac_storm]
    enabled = true
    max_pps_per_mac = 2000

    # --- ALGORITMO 4: FlapGuard ---
    [algorithms.flap_guard]
    enabled = true
    threshold = 5

    # --- ALGORITMO 5: ArpWatchdog ---
    [algorithms.arp_watch]
    enabled = true
    max_pps = 500

    # --- ALGORITMO 6: DhcpHunter ---
    [algorithms.dhcp_hunter]
    enabled = true
    trusted_macs = ["00:15:5d:01:02:03", "aa:bb:cc:dd:ee:ff"] 
    trusted_cidrs = ["192.168.1.0/24", "10.0.0.0/8"]

    # --- ALGORITMO 7: FlowPanic ---
    [algorithms.flow_panic]
    enabled = true
    max_pause_pps = 50 

    # --- ALGORITMO 8: RaGuard ---
    [algorithms.ra_guard]
    enabled = true
    trusted_macs = ["aa:bb:cc:dd:ee:ff"] 

    # --- ALGORITMO 9: McastPolicer ---
    [algorithms.mcast_policer]
    enabled = true
    max_pps = 8000

# --- TELEMETR√çA Y OBSERVABILIDAD ---
[telemetry]
enabled = true
listen_address = ":9090"
